"use strict";class offcanvas{constructor(){this.buf_params=JSON.parse(php_buf_params).params,this.currentDevice="desktop",this.topbar=document.querySelector("#buf_topbar"),this.ocbutton=document.querySelector("#bufoc_button"),this.bufcanvas=document.querySelector("#buf_offcanvas"),this.superwrapper=document.querySelector("#superwrapper"),this.startX=0,this.currentX=0,this.percent=0,this.touchingSideNav=!1,this.show_started=!1,this.show_complete=!1,this.hide_started=!1,this.hide_complete=!1,this.super_started=!1,this.offcanvas_media=this.offcanvas_media.bind(this),this.offcanvasClick=this.offcanvasClick.bind(this),this.showOffcanvas=this.showOffcanvas.bind(this),this.onSuperwrapperTouchStart=this.onSuperwrapperTouchStart.bind(this),this.onSuperwrapperTouchMove=this.onSuperwrapperTouchMove.bind(this),this.onSuperwrapperTouchEnd=this.onSuperwrapperTouchEnd.bind(this),this.vw=window.innerWidth,this.max_mobile=this.buf_params.oc_width,this.max_desktop=this.buf_params.oc_width_desktop,this.oc_max_px=0,this.init(),this.addEventListeners()}init(){0!=this.buf_params.offcanvas?document.documentElement.classList.add("buf_canvas"):this.buf_debug("offcanvas disabled")}offcanvas_media(){const s=window.innerWidth;this.vw=s,document.body.classList.remove("buf_oc_"+this.currentDevice),this.buf_debug(s),this.buf_debug(this.buf_params.media_w),s<=this.buf_params.media_w&&"desktop"==this.currentDevice?(this.currentDevice="mobile",this.offcanvasCreate(),this.buf_debug("looks like mobile")):s>=this.buf_params.media_w&&"mobile"==this.currentDevice&&(this.currentDevice="desktop",this.offcanvasRemove(),this.buf_debug("It looks like desktop")),document.body.classList.add("buf_oc_"+this.currentDevice),"mobile"==this.currentDevice?this.oc_max_px=this.max_mobile*(this.vw/100):this.oc_max_px=this.max_desktop*(this.vw/100)}offcanvasCreate(){this.buf_debug("show oc button"),this.topbar.classList.add("buf_oc_show"),this.ocbutton.classList.add("buf_oc_show"),this.topbar.classList.remove("buf_oc_hide"),this.ocbutton.classList.remove("buf_oc_hide"),this.topbar.setAttribute("aria-disabled","false"),this.bufcanvas.setAttribute("aria-disabled","false"),this.bufcanvas.setAttribute("aria-hidden","false")}offcanvasRemove(){if("mobile"==this.buf_params.offcanvas){this.topbar.classList.add("buf_oc_hide"),this.ocbutton.classList.add("buf_oc_hide"),this.topbar.classList.remove("buf_oc_show"),this.ocbutton.classList.remove("buf_oc_show"),this.ocbutton.classList.remove("is-active"),this.topbar.setAttribute("aria-disabled","true"),this.bufcanvas.setAttribute("aria-disabled","true"),this.bufcanvas.setAttribute("aria-hidden","true"),document.body.classList.remove("offcanvas_show");const s=document.querySelector("#buf_offcanvas");s.addEventListener("transitionend",function(s){document.body.classList.contains("offcanvas_show")||(document.body.classList.add("buf_offcanvas_hidden"),document.documentElement.classList.remove("buff_canvas_on"))})}}offcanvas_resize(){const s=this.offcanvas_media;window.addEventListener("resize",s)}addEventListeners(){0!=this.buf_params.offcanvas&&(this.ocbutton.addEventListener("click",this.offcanvasClick),"buf_off_cover"==this.buf_params.oc_style&&(this.superwrapper.addEventListener("touchstart",this.onSuperwrapperTouchStart,this.applyPassive()),this.superwrapper.addEventListener("touchmove",this.onSuperwrapperTouchMove,this.applyPassive()),this.superwrapper.addEventListener("touchend",this.onSuperwrapperTouchEnd)))}onSuperwrapperTouchStart(s){if(this.startX=s.touches[0].pageX,!this.show_complete){if("buf_off_pos_left"==this.buf_params.oc_position){if(this.startX>=50)return;this.buf_debug("touch start left"),this.bufcanvas.style.transform="translateX(-102%)",this.bufcanvas.style.transition="inherit",this.super_started=!0}if("buf_off_pos_right"==this.buf_params.oc_position){if(this.startX<=this.vw-50)return;this.buf_debug("touch start right: "+this.startX+"<="+(this.vw-50)),this.bufcanvas.style.transform="translateX(102%)",this.bufcanvas.style.transition="inherit",this.super_started=!0}}this.show_complete&&(this.super_started=!0,this.bufcanvas.style.transition="inherit","buf_off_pos_left"==this.buf_params.oc_position&&(this.bufcanvas.style.transform="translateX(0%)"),"buf_off_pos_right"==this.buf_params.oc_position&&(this.bufcanvas.style.transform="translateX(-100%)"))}onSuperwrapperTouchMove(s){if(!this.super_started)return;this.currentX=s.touches[0].pageX;let t=100-100*this.currentX/this.vw;"buf_off_pos_left"==this.buf_params.oc_position&&(!1===this.show_started&&this.showOffcanvas(),this.show_complete&&(t=-100*(this.currentX-this.startX)/this.oc_max_px),this.bufcanvas.style.transform=`translateX(-${t}%)`),"buf_off_pos_right"==this.buf_params.oc_position&&(!1===this.show_started&&this.showOffcanvas(),this.show_complete&&(t=100-100*(this.currentX-this.startX)/this.oc_max_px),t>=100&&(t=100),this.bufcanvas.style.transform=`translateX(-${t}%)`),this.percent=t}onSuperwrapperTouchEnd(s){if(this.super_started&&(this.super_started=!1,this.show_complete||("buf_off_pos_left"==this.buf_params.oc_position&&(this.currentX>=50?this.bufcanvas.style="":(this.bufcanvas.style="",this.hideOffcanvas())),"buf_off_pos_right"==this.buf_params.oc_position&&(this.currentX<=this.vw-100?this.bufcanvas.style="":(this.bufcanvas.style="",this.hideOffcanvas()))),this.show_complete&&("buf_off_pos_left"==this.buf_params.oc_position&&(this.percent>=20?(this.bufcanvas.style="",this.hideOffcanvas()):this.bufcanvas.style=""),"buf_off_pos_right"==this.buf_params.oc_position))){const s=100-this.percent;s>=20?(this.bufcanvas.style="",this.hideOffcanvas()):this.bufcanvas.style=""}}offcanvasClick(){this.buf_debug("offcanvasClick"),this.ocbutton.classList.contains("is-active")?this.hideOffcanvas():this.showOffcanvas()}showOffcanvas(){this.buf_debug("showOffcanvas"),this.show_started=!0,this.ocbutton.classList.add("is-active"),document.documentElement.classList.add("buff_canvas_on"),document.body.classList.add("offcanvas_show"),document.body.classList.remove("buf_offcanvas_hidden"),buf_offcanvas.ontransitionend=(()=>{this.buf_debug("Show transition complete"),this.show_complete=!0,this.show_started=!1})}hideOffcanvas(){this.buf_debug("hideOffcanvas"),document.body.classList.remove("offcanvas_show"),this.ocbutton.classList.remove("is-active"),buf_offcanvas.ontransitionend=(()=>{document.body.classList.contains("offcanvas_show")||(document.body.classList.add("buf_offcanvas_hidden"),document.documentElement.classList.remove("buff_canvas_on"),this.show_complete=!1,this.show_started=!1)})}applyPassive(){if(void 0!==this.supportsPassive)return!!this.supportsPassive&&{passive:!0};let s=!1;try{document.addEventListener("test",null,{get passive(){s=!0}})}catch(s){}return this.supportsPassive=s,this.applyPassive()}buf_debug(s){this.buf_params.debug&&console.log("BUF |-*-| "+s)}}new offcanvas;