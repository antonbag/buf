function buf_load_sccs_file(){var a=$(".buf_scss_toolbar");a.insertBefore($("#jform_params_scss_editor")),$(".buf_tb_icon").hide("fast"),$("#jform_params_buf_layout_files input").on("change",function(a){var t=$(this);t=$("#jform_params_buf_layout_files");setTimeout(function(){var a=t.find("input:checked").val(),e={templateid:templateid,action:"doreadsccsfile",tpath:tpath,file:a,layout:buf_layout},o={option:"com_ajax",plugin:"bufajax",data:e,format:"json"};$.ajax({type:"POST",dataType:"json",data:o,success:function(t){console.log(t),buf_editor.setValue(t.data[0]),"buf_layout.js"==a?$(".buf_tb_path").html("buf/layouts/"+buf_layout+"/js/"+a):"layout.php"==a?$(".buf_tb_path").html("buf/layouts/"+buf_layout+"/"+a):$(".buf_tb_path").html("buf/layouts/"+buf_layout+"/scss/"+a+".scss")},error:function(a){console.log("ERROR in load scss: "+a.responseText)}})},150)})}var buf_editor;document.addEventListener("DOMContentLoaded",function(){function a(t){"undefined"==typeof CodeMirror||0==$(".CodeMirror").length?setTimeout(function(){a(t)},500):t()}a(function(){codeMirrorDiv=document.querySelector(".CodeMirror"),codeMirrorDiv.remove(),document.getElementById("jform_params_scss_editor").setAttribute("name","cleaned_editor"),buf_editor=CodeMirror.fromTextArea(document.getElementById("jform_params_scss_editor"),{autofocus:!1,lineWrapping:!0,styleActiveLine:!0,lineNumbers:!0,gutters:["CodeMirror-linenumbers","CodeMirror-foldgutter","CodeMirror-markergutter"],foldGutter:!0,markerGutter:!0,mode:"scss",theme:"default",autoCloseBrackets:!0,matchBrackets:!0,scrollbarStyle:"native",keyMap:"default"}),buf_load_sccs_file(),setTimeout(function(){$("#jform_params_buf_layout_files input:checked").trigger("change")},500)})},!1),jQuery(function(a){"use strict";function t(){a(".btn_buf_clean").on("click",function(t){t.preventDefault();var e=a(this).children("a").attr("class"),o={templateid:templateid,action:e,tpath:tpath,layout:buf_layout},s={option:"com_ajax",plugin:"bufajax",data:o,format:"json"};return a.ajax({type:"POST",dataType:"json",data:s,beforeSend:function(a){},success:function(t){"do_clean_bs"==e?(a("div.do_clean_bs div.buf_toolbar_file_info").html(t.data),a("div.do_clean_bs div.btn_buf_clean").remove()):(a("div.do_clean_fa div.buf_toolbar_file_info").html(t.data),a("div.do_clean_fa div.btn_buf_clean").remove())},error:function(t){console.log(t),a("#compile_fa_sass > .btn").html('<i class="fa fa-exclamation-circle"></i> error :/')}}),!1})}function e(){}function o(){}function s(){a(".header-title");var t=a(".buf_template_data");t.appendTo(a("#details .row .col-md-3 .card-body")),a("#jform_params_buf_layout").parent().addClass("jform_params_buf_layout"),a("#toolbar-buf_empy_cache").appendTo("#toolbar"),a("#details >.row >.col-md-9 >div.info-labels").remove()}function n(){a("button.button-apply, button.button-save").click(function(t){event.preventDefault();var e=a("ul#myTabTabs li.active a").attr("href");"#attrib-layout"==e&&(a("a.buf_scss_save").trigger("click"),setTimeout(function(){},1e3))})}function i(){a("#toolbar-buf_empy_cache button").on("click",function(t){t.preventDefault();var e={templateid:templateid,action:"do_clear_cache",tpath:tpath,layout:buf_layout},o={option:"com_ajax",plugin:"bufajax",data:e,format:"json"};return a.ajax({type:"POST",dataType:"json",data:o,beforeSend:function(t){a("#toolbar-buf_empy_cache > .buf_clear_cache_status").html('<i class="fa fa-cog fa-spin buf-loading"></i>')},success:function(t){a("#toolbar-buf_empy_cache .buf_clearcache_icon").hide(),"ok"==t.data?a("#toolbar-buf_empy_cache .buf_clear_cache_status").html('<i class="fas fa-badge-check"></i>'):(console.log(t),a("#toolbar-buf_empy_cache .buf_clear_cache_status").html('<i class="fas fa-times-octagon"></i>')),setTimeout(function(){a("#toolbar-buf_empy_cache .buf_clear_cache_status").html(""),a("#toolbar-buf_empy_cache .buf_clearcache_icon").show()},1e3)},error:function(t){console.log(t),a("#compile_bs_sass > .btn").html('<i class="fa fa-exclamation-circle"></i> error :/')}}),!1})}function l(){var t="";t+="",a(t).insertAfter("#toolbar-cancel")}function c(){if(a("#compile_bs_sass, div.bs4_custom_btn a").on("click",function(t){t.preventDefault();var e={templateid:templateid,action:"doreload_bs_sass",tpath:tpath,layout:buf_layout},o={option:"com_ajax",plugin:"bufajax",data:e,format:"json"};return a.ajax({type:"POST",dataType:"json",data:o,beforeSend:function(t){a("#compile_bs_sass > .btn").html('<i class="fa fa-cog fa-spin buf-loading"></i> processing')},success:function(a){Joomla.submitform("style.apply",document.getElementById("style-form"))},error:function(t){console.log(t),a("#compile_bs_sass > .btn").html('<i class="fa fa-exclamation-circle"></i> error :/')}}),!1}),"1"==a("#reloadbs").val()){a("#system-message-container > div").remove();var e={templateid:templateid,action:"do_bs_sass",tpath:tpath,layout:buf_layout},o={option:"com_ajax",plugin:"bufajax",data:e,format:"json"};a.ajax({type:"POST",dataType:"json",data:o,beforeSend:function(t){a("#compile_bs_sass > .btn").html('<i class="fa fa-cog fa-spin buf-loading"></i> processing')},success:function(e){console.log(e),0==e.success?a("#compile_bs_sass > .btn").html('<i class="icon-warning"></i>ERROR '+e.message):(console.log(e.data[0].debug),a("#compile_bs_sass > .btn").html('<i class="icon-save"></i>compiled'),setTimeout(function(){a("#compile_bs_sass > .btn").html('<i class="icon-play"></i>Compile BS');var o=e.data[0].file_data.file_name+e.data[0].file_data.file_date+e.data[0].file_data.file_size;a("div.do_clean_bs div.buf_toolbar_file_info").html(o),a(".do_clean_bs .buf_toolbar_file_buttons .btn_buf_clean").length<=0&&(a("#compile_bs_sass").after(e.data[0].file_data.file_clean),t())},1e3))},error:function(t){a("#compile_bs_sass > .btn").html('<i class="icon-warning"></i>ERROR'),console.log(t)}})}}function _(){if(a("#compile_fa_sass").on("click",function(t){t.preventDefault();var e={templateid:templateid,action:"doreload_fa_sass",tpath:tpath,layout:buf_layout},o={option:"com_ajax",plugin:"bufajax",data:e,format:"json"};return a.ajax({type:"POST",dataType:"json",data:o,beforeSend:function(t){a("#compile_fa_sass > .btn").html('<i class="fa fa-cog fa-spin buf-loading"></i> processing')},success:function(a){Joomla.submitform("style.apply",document.getElementById("style-form"))},error:function(t){console.log(t),a("#compile_fa_sass > .btn").html('<i class="fa fa-exclamation-circle"></i> error :/')}}),!1}),"1"==a("#reloadfa").val()){a("#system-message-container > div").remove();var e={templateid:templateid,action:"do_fa_sass",tpath:tpath,layout:buf_layout},o={option:"com_ajax",plugin:"bufajax",data:e,format:"json"};a.ajax({type:"POST",dataType:"json",data:o,beforeSend:function(t){a("#compile_fa_sass > .btn").html('<i class="fa fa-cog fa-spin buf-loading"></i> processing')},success:function(e){console.log(e),a("#compile_fa_sass > .btn").html('<i class="icon-save"></i>compiled'),setTimeout(function(){a("#compile_fa_sass > .btn").html('<i class="icon-play"></i>Compile FA'),a("#compile_fa_sass > .btn").html('<i class="icon-play"></i>Compile FA');var o=e.data[0].file_data.file_name+e.data[0].file_data.file_date+e.data[0].file_data.file_size;a("div.do_clean_fa div.buf_toolbar_file_info").html(o),a(".do_clean_fa .buf_toolbar_file_buttons .btn_buf_clean").length<=0&&a("#compile_fa_sass").after(e.data[0].file_data.file_clean),t()},1e3)},error:function(t){a("#compile_fa_sass > .btn").html('<i class="icon-warning"></i>ERROR'),console.log(t)}})}}function f(){a("a.buf_scss_save").on("click",function(t){t.preventDefault();var e=buf_editor.getValue(),o=a("#jform_params_buf_layout_files").find("input:checked").val(),s={templateid:templateid,action:"dosavesccsfile",tpath:tpath,file:o,layout:buf_layout,text:e},n={option:"com_ajax",plugin:"bufajax",data:s,format:"json"};a.ajax({type:"POST",dataType:"json",data:n,success:function(t){a(".buf_tb_icon").show("fast"),a(".buf_tb_msg").html(t.data[0]).hide().show("slow"),a(".buf_scss_save").addClass("disabled"),setTimeout(function(){a(".buf_tb_msg").hide("slow",function(){a(this).html(""),a(".buf_scss_save").removeClass("disabled")}),a(".buf_tb_icon").hide("fast")},2e3)},error:function(t){a(".buf_tb_msg").html("Fatal error :( ")}})})}function u(){a("#jform_params_buf_layout").on("change",function(){""==a(this).val()||a(this).val(),Joomla.submitform("style.apply",document.getElementById("style-form"))})}function r(){a(".buf_layout_new_name_wrapper").hide(),a(".buf_duplicate_layout_a").click(function(){a(".buf_duplicate_layout_a").hide("slow"),a(".buf_layout_new_name_wrapper").show("slow")}),a(".buf_btn_create_layout").on("click",function(t){t.preventDefault(),a(".buf_btn_create_layout .fa-cog").addClass("fa-spin");var e=a("#buf_layout_name").val(),o=b(e);if("valid"!=o)a(".buf_layout_toolbar_status").html(o).show("slow"),a(".buf_btn_create_layout .fa-cog").removeClass("fa-spin"),setTimeout(function(){a(".buf_layout_toolbar_status").hide("slow")},2e3);else{var s={templateid:templateid,action:"doduplicatelayout",tpath:tpath,name:e,layout:buf_layout},n={option:"com_ajax",plugin:"bufajax",data:s,format:"json"};a.ajax({type:"POST",dataType:"json",data:n,success:function(t){"OK"!=t.data?a(".buf_layout_toolbar_status").html(t.data).show("slow"):Joomla.submitform("style.apply",document.getElementById("style-form"))},error:function(t){a(".buf_layout_toolbar_status").html("Fatal error :( ").show("slow"),console.log(t)}})}}),a(".buf_btn_cancel_layout").click(function(){a(".buf_btn_create_layout .fa-cog").removeClass("fa-spin"),a(".buf_duplicate_layout_a").show("slow"),a(".buf_layout_new_name_wrapper").hide("slow")})}function b(a){if(a.length>=30)return"Name too long";var t=/^[\\da-zA-Z0-9\-\_]{1,30}$/.test(a.toLowerCase())?"valid":"Name not valid";return t}function m(){a(".buf_zip_layout_a").on("click",function(t){t.preventDefault();var e=a(this);e.addClass("disabled");var o={templateid:templateid,action:"do_zip_layout",tpath:tpath,layout:buf_layout},s={option:"com_ajax",plugin:"bufajax",data:o,format:"json"};console.log(s),a.ajax({type:"POST",dataType:"json",data:s,success:function(t){console.log(t.data),"ok"==t.data[0].status?a(".buf_layout_toolbar_status").html('<a download rel="nofollow" href="'+t.data[0].file_path+'">Download '+t.data[0].filename+"</a>"):(console.log(t.data),a(".buf_layout_toolbar_status").html("Error in backup. See console log.")),e.removeClass("disabled")},error:function(t){a(".buf_layout_toolbar_status").html("Fatal Error in backup. See console log."),a(this).removeClass("disabled"),console.log(t)}})})}function d(){var t="";t+='<a class="mt-2 btn btn-default bg-info text-light buf_favicon_btn_create" title="Create favicon" href="#"><i class="fa fa-magic"></i> Create favicons</a>',t+="",a(t).insertAfter(a("#imageModal_jform_params_buf_favicon").parent()),a(".buf_favicon_btn_create").on("click",function(t){t.preventDefault();var e=a("#jform_params_buf_favicon").val();if(""==e)return alert("You have not selected an image"),!1;var o={templateid:templateid,action:"dofavicon",tpath:tpath,image:e,layout:buf_layout},s={option:"com_ajax",plugin:"bufajax",data:o,format:"json"};return a.ajax({type:"POST",dataType:"json",data:s,success:function(t){"true"!=t.data?(a(".buffavicons_messages").show(),a(".buf_favicon_btn_create").addClass("btn-warning").html('<span class="icon-delete"></span> NOT created'),setTimeout(function(){a(".buf_favicon_btn_create").removeClass("btn-warning").html('<i class="fa fa-magic"></i> Create favicons')},2e3),a(".buffavicons_messages").addClass("alert").html(t.data)):(a(".buf_favicon_btn_create").html('<i class="fa fa-cog fa-spin"></i> Creating'),setTimeout(function(){a(".buf_favicon_btn_create").html('<span class="icon-save"></span>created'),a(".buffavicons_messages").hide()},2e3),setTimeout(function(){a(".buf_favicon_btn_create").html('<i class="fa fa-magic"></i> Create favicon')},3e3),setTimeout(function(){var t=new Date;a(".buffavicons_thumbs_wrapper").html('<div class="buffavicons_thumbs buffavicons_thumbs_svg"><div class="buffavicons_thumbs_svg_img"><img src="../templates/buf/images/icons/svgfavicon.svg" width="64"/></div></div><div class="buffavicons_thumbs"><img src="../templates/buf/layouts/'+buf_layout+"/icons/favicon-96x96.png?"+t.getTime()+'" title="96x96"/></div><div class="buffavicons_thumbs"><img src="../templates/buf/layouts/'+buf_layout+"/icons/apple-icon-57x57.png?"+t.getTime()+'" title="57x57"/></div><div class="buffavicons_thumbs"><img src="../templates/buf/layouts/'+buf_layout+"/icons/favicon-16x16.png?"+t.getTime()+'" title="16x16"/></div>')},1e3)),console.log(t)},error:function(){console.log("error")}}),!1})}function p(){a("#jform_params__buf_bs_v5__buf_bootstrap_css").change(function(){})}function h(t){var e=a("#jform_params__buf_bs_v5__buf_bs_files_core input"),o=a("#jform_params__buf_bs_v5__buf_bs_files_layout input"),s=a("#jform_params__buf_bs_v5__buf_bs_files_components input"),n=a("#jform_params__buf_bs_v5__buf_bs_files_helpers input"),i=["functions","variables","maps","mixins","utilities","grid"],l=["functions","variables","maps","mixins","root","reboot","utilities","grid","type","images","containers","grid","tables","forms","buttons","transitions","dropdown","button-group","nav","navbar","card","pagination","list-group","close","api"];if(t=t.toLowerCase(),"none"==t)e.prop("checked",!1),o.prop("checked",!1),s.prop("checked",!1),n.prop("checked",!1),document.querySelectorAll("#jform_params__buf_bs_v5__buf_bs_files_core input").forEach(function(a){a.checked=!1});else if("minimum"==t)e.prop("checked",!1),o.prop("checked",!1),s.prop("checked",!1),n.prop("checked",!1),i.forEach(function(a){document.querySelectorAll('#jform_params__buf_bs_v5__buf_bs_files_core input[value="'+a+'"]').forEach(function(a){a.checked=!0}),document.querySelectorAll('#jform_params__buf_bs_v5__buf_bs_files_layout input[value="'+a+'"]').forEach(function(a){a.checked=!0}),document.querySelectorAll('#jform_params__buf_bs_v5__buf_bs_files_components input[value="'+a+'"]').forEach(function(a){a.checked=!0}),document.querySelectorAll('#jform_params__buf_bs_v5__buf_bs_files_helpers input[value="'+a+'"]').forEach(function(a){a.checked=!0})});else if("recommended"==t){e.prop("checked",!1),o.prop("checked",!1),s.prop("checked",!1),n.prop("checked",!1),a.each(l,function(t,e){a('#jform_params__buf_bs_v5__buf_bs_files_core input[value="'+e+'"]').prop("checked",!0),a('#jform_params__buf_bs_v5__buf_bs_files_layout input[value="'+e+'"]').prop("checked",!0),a('#jform_params__buf_bs_v5__buf_bs_files_components input[value="'+e+'"]').prop("checked",!0),a('#jform_params__buf_bs_v5__buf_bs_files_helpers input[value="'+e+'"]').prop("checked",!0)})}else"all"!=t&&"custom"!=t||(e.prop("checked",!0),o.prop("checked",!0),s.prop("checked",!0),n.prop("checked",!0))}a(document).ready(function(){e(),d(),l(),c(),_(),t(),f(),p(),r(),u(),o(),n(),i(),m(),s(),a("#jform_params__buf_bs_v4__buf_bs_selector").trigger("change"),a("#jform_params__buf_bs_v5__buf_bs_selector").trigger("change");var b=a("#jform_params_buf_layout").val();null!=b&&""!=b||(b="default")}),a("#jform_params__buf_bs_v5__buf_bs_selector input").click(function(){h(a(this).val()),console.log(a(this).val())})});